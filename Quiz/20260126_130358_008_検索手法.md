# RAG理解度テスト - 問題008

## 問題情報
- **問題番号**: 008
- **カテゴリ**: 検索手法
- **難易度**: 上級
- **作成日時**: 2026-01-26 13:03:58

## 問題文

**Q8. RRF（Reciprocal Rank Fusion）とは何ですか？このアプリでは、Semantic検索とキーワード検索の結果をRRFでどのように融合していますか？RRFの計算式と、semantic_weightとkeyword_weightの役割について説明してください。**

---

## 回答欄

（ここに回答を記入してください）
RRF（Reciprocal Rank Fusion）とは意味検索の結果とキーワード検索の結果をweightに基づいてスコアリングし候補の採用優先順位を決める過程です。
---

## 評価欄

### 理解度評価
- [x] レベル1（基礎）: 用語を説明できる、基本的な流れを理解している
- [ ] レベル2（応用）: 技術の仕組みを説明できる、手法の違いを理解している
- [ ] レベル3（実践）: 実装の詳細を説明できる、精度向上の方法を提案できる

### 評価コメント
**良い点：**
- RRFの基本的な役割（意味検索とキーワード検索の結果を融合）を理解している
- weightに基づいてスコアリングすることを認識している

**改善点：**
- **RRFの計算式が不足**。RRF（Reciprocal Rank Fusion）の計算式は：
  ```
  RRF_score = semantic_weight / (rrf_k + rank_sem) + keyword_weight / (rrf_k + rank_kw)
  ```
  - `rrf_k`は定数（通常60）、`rank_sem`と`rank_kw`はそれぞれの検索結果での順位（1始まり）
  - 順位が低い（数値が大きい）ほど、RRFスコアは小さくなる
- **semantic_weightとkeyword_weightの役割**：
  - semantic_weightが大きいと、意味検索の結果が優先される
  - keyword_weightが大きいと、キーワード検索の結果が優先される
  - 実装では、semantic_weight + keyword_weight = 1.0 になるように調整される
- **実装の詳細**：`app/rag/hybrid_retrieval.py`の`_merge_with_rrf`関数で実装されている

### 不足している知識
- RRFの計算式とrrf_kパラメータの意味
- semantic_weightとkeyword_weightの具体的な役割と調整方法
- なぜRRFを使うのか（単純なスコア合算との違い）

### 改善点
- RRFの計算式を正確に説明できるとレベル2に到達
- rrf_kパラメータの意味や、weightの調整による影響を説明できるとレベル3

---

## 参考情報

このアプリの実装を確認する場合:
- `backend/app/rag/hybrid_retrieval.py` の `_merge_with_rrf` 関数を確認
- `backend/app/core/settings.py` で `rrf_k` パラメータを確認
